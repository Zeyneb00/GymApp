@page "{id:int}"
@model GymApp.Pages.Lessons.DetailsModel

@{
    ViewData["Title"] = "Lesson Details";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

<div class="container mt-4">

    <a asp-page="/Lessons/List" asp-route-id="@Model.Lesson.CategoryId" class="btn btn-link">
        ← Back to Lessons
    </a>

    <div class="card shadow-lg p-4">
        <div class="row">
            <div class="col-md-4 d-flex flex-column align-items-center justify-content-center">
                <div class="rounded-circle bg-secondary mb-3"
                     style="width:150px; height:150px; background-size:cover;">
                </div>

                <h4 class="text-primary">@Model.Lesson.InstructorName</h4>
                <p class="text-muted">Instructor</p>
            </div>

            <div class="col-md-8">
                <h2 class="fw-bold">@Model.Lesson.Name</h2>
                <p class="text-muted">@Model.Lesson.Category.Name</p>

                <hr />

                <p><strong>Studio:</strong> @Model.Lesson.StudioLocation</p>

                <p>
                    <strong>Day:</strong>
                    <span class="badge bg-primary">@Model.Lesson.DayOfWeek</span>
                </p>

                <p>
                    <strong>Time:</strong>
                    <span class="badge bg-info text-dark">
                        @Model.Lesson.Time.ToString(@"hh\:mm")
                    </span>
                </p>

                <p>
                    <strong>Capacity:</strong>
                    @Model.Lesson.Registrations.Count / @Model.Lesson.MaxCapacity
                </p>

                <div class="progress mb-3">
                    <div class="progress-bar
                        @(Model.Lesson.Registrations.Count >= Model.Lesson.MaxCapacity ? "bg-danger" : "bg-success")"
                         role="progressbar"
                         style="width:@((Model.Lesson.Registrations.Count * 100) / Model.Lesson.MaxCapacity)%;">
                    </div>
                </div>

                @if (TempData["ErrorMessage"] != null)
                {
                    <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
                }

                <form method="post">
                    <button type="submit"
                            class="btn btn-lg btn-success"
                            @(Model.Lesson.Registrations.Count >= Model.Lesson.MaxCapacity ? "disabled" : "")>
                        Register for this Lesson
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
